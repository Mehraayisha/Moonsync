<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Moonsync Tracker</title>

  {% load static %}
  <link rel="stylesheet" href="{% static 'styles/tracking.css' %}">
</head>

<body>

  <!-- ================= NAVBAR ================= -->
  <nav class="navbar">
    <div class="nav-left">
      <img src="{% static 'image/logo.jpg' %}" alt="logo" width="60px">
      <p class="logo-text">MOONSYNC</p>
    </div>

    <!-- Calendar Icon -->
    <button id="calendarBtn" class="calendar-btn">ðŸ“…</button>
  </nav>


  <!-- ================= HERO SECTION ================= -->
  <section class="hero">

    <div class="greeting">
      <h2>{{ greeting }}, {{ request.user.username }}</h2>
      <p>Welcome back to your tracker</p>
    </div>

    {% if period_data.on_period %}
      <div class="outer-circle">
        <div class="progress-ring"
             style="--progress: {{ period_data.progress }};">
        </div>

        <div class="inner-circle">
          <h2>{{ period_data.day_of_period }}</h2>
          <p>of {{ period_data.period_duration }} days</p>
        </div>
      </div>

    {% else %}
      <div class="no-period">
        <h3>Your period is coming in</h3>
        <h1>{{ period_data.days_left }} days</h1>
      </div>
    {% endif %}

  </section>


  <!-- ================= DASHBOARD SECTION ================= -->
  <div class="container">
    <h2>Your Dashboard</h2>
    <p>Track your tasks and progress efficiently.</p>
  </div>


  <!-- ================= CALENDAR MODAL ================= -->
  <div id="calendarModal" class="calendar-modal">

    <div class="calendar-content">
      <span id="closeCalendar" class="close-btn">&times;</span>

      <h2 class="calendar-title">Your Calendar</h2>

      <div id="calendar">

        <!-- Week Names -->
        <div class="calendar-row weekday-row">
          {% for day in week_names %}
            <div class="day-name">{{ day }}</div>
          {% endfor %}
        </div>

        <!-- Dates -->
        <div class="calendar-row date-row">
          {% for day in week_dates %}
            <div class="day
                {% if day in period_dates %}has-period{% endif %}
                {% if day.day == current_day_number %}current-day{% endif %}">
              
              {{ day.day }}

              {% if day in period_dates %}
                <div class="red-dot"></div>
              {% endif %}

            </div>
          {% endfor %}
        </div>

      </div>
    </div>
  </div>


  <!-- ================= JAVASCRIPT ================= -->
  <script>
    const calendarBtn = document.getElementById("calendarBtn");
    const calendarModal = document.getElementById("calendarModal");
    const closeCalendar = document.getElementById("closeCalendar");

    calendarBtn.addEventListener("click", () => {
      calendarModal.style.display = "flex";
    });

    closeCalendar.addEventListener("click", () => {
      calendarModal.style.display = "none";
    });

    window.addEventListener("click", (e) => {
      if (e.target === calendarModal) {
        calendarModal.style.display = "none";
      }
    });
  </script>

</body>
</html>
